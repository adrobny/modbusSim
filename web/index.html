<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modbus RTU Simulator</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <h1>Modbus RTU Simulator</h1>

        <div class="main-grid">
            <div class="left-column">
                <div class="config-panel">
                    <h2>Konfigurace Portu</h2>
                    <div class="form-group">
                        <label>Baud Rate:</label>
                        <select id="baudRate">
                            <option value="1200">1200</option>
                            <option value="2400">2400</option>
                            <option value="4800">4800</option>
                            <option value="9600" selected>9600</option>
                            <option value="14400">14400</option>
                            <option value="19200">19200</option>
                            <option value="38400">38400</option>
                            <option value="57600">57600</option>
                            <option value="115200">115200</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Data Bits:</label>
                        <select id="dataBits">
                            <option value="7">7</option>
                            <option value="8" selected>8</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Stop Bits:</label>
                        <select id="stopBits">
                            <option value="1" selected>1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Parity:</label>
                        <select id="parity">
                            <option value="none" selected>None</option>
                            <option value="even">Even</option>
                            <option value="odd">Odd</option>
                        </select>
                    </div>
                    <div class="control-panel">
                        <button id="connectBtn" class="btn btn-primary">Připojit Port</button>
                        <button id="disconnectBtn" class="btn btn-secondary" disabled>Odpojit</button>
                    </div>
                    <div class="status-panel">
                        <div id="status" class="status">Nepřipojeno</div>
                        <div id="portInfo" class="port-info"></div>
                    </div>
                </div>

                <div class="config-panel">
                    <h2>Správa Zařízení</h2>
                    <div class="control-panel">
                        <button id="exportBtn" class="btn btn-info">Export JSON</button>
                        <button id="importBtn" class="btn btn-info">Import JSON</button>
                        <button id="quickLoadCG" class="btn btn-warning">Načíst CG-EN500</button>
                        <input type="file" id="fileInput" style="display: none;" accept=".json">
                    </div>
                    <div class="form-group">
                        <label>Název zařízení:</label>
                        <input type="text" id="deviceName" value="Moje Zařízení">
                    </div>
                </div>
            </div>

            <div class="right-column">
                <div class="registers-panel">
                    <div class="panel-header">
                        <h2>Registry</h2>
                        <button id="addRegisterBtn" class="btn btn-small btn-success">+ Přidat Registr</button>
                    </div>
                    <div class="registers-container">
                        <table id="registersTable">
                            <thead>
                                <tr>
                                    <th>Adresa</th>
                                    <th>Typ</th>
                                    <th>Data Type</th>
                                    <th>Hodnota</th>
                                    <th>Název/Popis</th>
                                    <th>Akce</th>
                                </tr>
                            </thead>
                            <tbody id="registersBody">
                                <!-- Registers will be generated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="log-panel">
            <div class="panel-header">
                <h2>Log</h2>
                <button id="clearLogBtn" class="btn btn-small btn-secondary">Vymazat</button>
            </div>
            <div id="log" class="log"></div>
        </div>
    </div>

    <!-- Modal for Adding/Editing Register -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitle">Přidat Registr</h2>
            <form id="registerForm">
                <input type="hidden" id="editIndex" value="-1">
                <div class="form-group">
                    <label>Adresa (0-65535):</label>
                    <input type="number" id="regAddress" min="0" max="65535" required>
                </div>
                <div class="form-group">
                    <label>Typ Modbus:</label>
                    <select id="regType">
                        <option value="HoldingRegister">Holding Register (4x)</option>
                        <option value="InputRegister">Input Register (3x)</option>
                        <option value="Coil">Coil (0x)</option>
                        <option value="DiscreteInput">Discrete Input (1x)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Datový Typ:</label>
                    <select id="regDataType">
                        <option value="uint16">UInt16</option>
                        <option value="int16">Int16</option>
                        <option value="uint32">UInt32</option>
                        <option value="int32">Int32</option>
                        <option value="float32">Float32</option>
                        <option value="float64">Float64</option>
                        <option value="boolean">Boolean</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Hodnota:</label>
                    <input type="text" id="regValue" value="0">
                </div>
                <div class="form-group">
                    <label>Název:</label>
                    <input type="text" id="regName" placeholder="Např. Teplota">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Uložit</button>
                    <button type="button" id="cancelModalBtn" class="btn btn-secondary">Zrušit</button>
                </div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>